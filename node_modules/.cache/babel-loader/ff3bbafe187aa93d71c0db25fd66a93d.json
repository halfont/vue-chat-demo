{"remainingRequest":"/home/tal/development/vue-scaffold/node_modules/babel-loader/lib/index.js!/home/tal/development/vue-scaffold/node_modules/cache-loader/dist/cjs.js??ref--0-0!/home/tal/development/vue-scaffold/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/tal/development/vue-scaffold/src/views/ChatRoom.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/tal/development/vue-scaffold/src/views/ChatRoom.vue","mtime":1599666782860},{"path":"/home/tal/development/vue-scaffold/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/tal/development/vue-scaffold/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/tal/development/vue-scaffold/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/tal/development/vue-scaffold/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZm9yLWVhY2giOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QudG8tc3RyaW5nIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc2V0IjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLml0ZXJhdG9yIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5mb3ItZWFjaCI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuaXRlcmF0b3IiOwppbXBvcnQgX29iamVjdFNwcmVhZCBmcm9tICIvaG9tZS90YWwvZGV2ZWxvcG1lbnQvdnVlLXNjYWZmb2xkL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9vYmplY3RTcHJlYWQyIjsKLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KaW1wb3J0IHsgbWFwR2V0dGVycyB9IGZyb20gInZ1ZXgiOwoKdmFyIGF4aW9zID0gcmVxdWlyZSgiYXhpb3MiKTsKCmltcG9ydCBzdG9yZSBmcm9tICIuLi9zdG9yZSI7CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAiQ2hhdFJvb20iLAogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBtZXNzYWdlOiAiIiwKICAgICAgcm9vbU51bTogdGhpcy4kcm91dGVyLmN1cnJlbnRSb3V0ZS5wYXJhbXMucm9vbUlkLAogICAgICB1c2Vyc0luUm9vbTogW10sCiAgICAgIHRpbWVvdXRJZHM6IFtdCiAgICB9OwogIH0sCiAgYmVmb3JlRGVzdHJveTogZnVuY3Rpb24gYmVmb3JlRGVzdHJveSgpIHsKICAgIHRoaXMua2lsbFRpbWVvdXRzKCk7CiAgfSwKICBtb3VudGVkOiBmdW5jdGlvbiBtb3VudGVkKCkgewogICAgdGhpcy5raWxsVGltZW91dHMoKTsKICAgIHRoaXMucG9sbCh0aGlzLmdldENoYXRUZXh0KTsKICAgIHRoaXMucG9sbCh0aGlzLmdldFVzZXJMaXN0KTsKICAgIHRoaXMucG9sbCh0aGlzLmdldEFsbFVzZXJzKTsKICB9LAogIG1ldGhvZHM6IHsKICAgIHBvbGw6IGZ1bmN0aW9uIHBvbGwoY2IpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIHZhciBpZCA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgIGNiKCkudGhlbihfdGhpcy5wb2xsKGNiKSkuY2F0Y2goZnVuY3Rpb24gKCkgewogICAgICAgICAgY29uc29sZS5lcnJvcigic29tdGhpbmcgd2VudCB3cm9uZy4gcGxlYXNlIHRyeSBhZ2FpbiBsYXRlciIpOwogICAgICAgIH0pOwogICAgICB9LCA1MDApOwogICAgICB0aGlzLnRpbWVvdXRJZHMucHVzaChpZCk7CiAgICB9LAogICAga2lsbFRpbWVvdXRzOiBmdW5jdGlvbiBraWxsVGltZW91dHMoKSB7CiAgICAgIHRoaXMudGltZW91dElkcy5mb3JFYWNoKGZ1bmN0aW9uIChpZCkgewogICAgICAgIGNsZWFyVGltZW91dChpZCk7CiAgICAgIH0pOwogICAgfSwKICAgIHNjcm9sbFRvRW5kOiBmdW5jdGlvbiBzY3JvbGxUb0VuZCgpIHsKICAgICAgdmFyIGNvbnRhaW5lciA9IHRoaXMuJGVsLnF1ZXJ5U2VsZWN0b3IoIiNsaXN0T2ZUZXh0Iik7CiAgICAgIGNvbnRhaW5lci5zY3JvbGxUb3AgPSBjb250YWluZXIuc2Nyb2xsSGVpZ2h0OwogICAgfSwKICAgIG9uU3VibWl0OiBmdW5jdGlvbiBvblN1Ym1pdCgpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CgogICAgICBpZiAodGhpcy5tZXNzYWdlICE9PSAiIikgewogICAgICAgIHJldHVybiBheGlvcy5wb3N0KCIvcm9vbXMvIi5jb25jYXQodGhpcy5yb29tTnVtLCAiL3RleHQiKSwgewogICAgICAgICAgdGV4dDogdGhpcy5tZXNzYWdlLAogICAgICAgICAgdXNlcklkOiB0aGlzLmxvZ2dlZGluVXNlci5pZAogICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgICAgX3RoaXMyLmdldENoYXRUZXh0KCk7CiAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7CiAgICAgICAgICBjb25zb2xlLmVycm9yKGVycm9yKTsKICAgICAgICB9KTsKICAgICAgfQogICAgfSwKICAgIGdldENoYXRUZXh0OiBmdW5jdGlvbiBnZXRDaGF0VGV4dCgpIHsKICAgICAgdmFyIF90aGlzMyA9IHRoaXM7CgogICAgICByZXR1cm4gYXhpb3MuZ2V0KCIvcm9vbXMvIi5jb25jYXQodGhpcy5yb29tTnVtLCAiL3RleHQiKSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICB2YXIgcklkID0gX3RoaXMzLiRyb3V0ZXIuY3VycmVudFJvdXRlLnBhcmFtcy5yb29tSWQ7CiAgICAgICAgdmFyIGNoYXREYXRhID0gW107CiAgICAgICAgY2hhdERhdGFbcklkXSA9IHJlc3BvbnNlLmRhdGEudGV4dDsKICAgICAgICBzdG9yZS5kaXNwYXRjaCgicm9vbXMvc2V0Q2hhdERhdGEiLCBjaGF0RGF0YSk7CgogICAgICAgIF90aGlzMy4kbmV4dFRpY2soZnVuY3Rpb24gKCkgewogICAgICAgICAgdGhpcy5zY3JvbGxUb0VuZCgpOwogICAgICAgIH0pOwogICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHsKICAgICAgICBjb25zb2xlLmVycm9yKGVycm9yKTsKICAgICAgfSk7CiAgICB9LAogICAgZ2V0VXNlckxpc3Q6IGZ1bmN0aW9uIGdldFVzZXJMaXN0KCkgewogICAgICB2YXIgX3RoaXM0ID0gdGhpczsKCiAgICAgIHJldHVybiBheGlvcy5nZXQoIi9yb29tcy8iLmNvbmNhdCh0aGlzLnJvb21OdW0sICIvdXNlcnMiKSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICBfdGhpczQudXNlcnNJblJvb20gPSBuZXcgU2V0KHJlc3BvbnNlLmRhdGEudXNlcnMpOwogICAgICAgIHN0b3JlLmRpc3BhdGNoKCJyb29tcy9zZXRVc2VycyIsIHJlc3BvbnNlLmRhdGEudXNlcnMpOwogICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHsKICAgICAgICBjb25zb2xlLmVycm9yKGVycm9yKTsKICAgICAgfSk7CiAgICB9LAogICAgZ2V0QWxsVXNlcnM6IGZ1bmN0aW9uIGdldEFsbFVzZXJzKCkgewogICAgICByZXR1cm4gYXhpb3MuZ2V0KCIvdXNlcnMiKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgIHN0b3JlLmRpc3BhdGNoKCJyb29tcy9zZXRBbGxVc2VycyIsIHJlc3BvbnNlLmRhdGEpOwogICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHsKICAgICAgICBjb25zb2xlLmVycm9yKGVycm9yKTsKICAgICAgfSk7CiAgICB9CiAgfSwKICBjb21wdXRlZDogX29iamVjdFNwcmVhZCh7fSwgbWFwR2V0dGVycyh7CiAgICBjaGF0RGF0YTogInJvb21zL2NoYXREYXRhIiwKICAgIHVzZXJzTGlzdDogInJvb21zL3VzZXJzTGlzdCIsCiAgICBhbGxVc2Vyc0xpc3Q6ICJyb29tcy9hbGxVc2Vyc0xpc3QiLAogICAgbG9nZ2VkaW5Vc2VyOiAicm9vbXMvbG9nZ2VkaW5Vc2VyIgogIH0pKQp9Ow=="},{"version":3,"sources":["ChatRoom.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div class=\"chatRoom\">\n    <v-navigation-drawer :permanent=\"true\" absolute dark fixed :width=\"150\">\n      <v-list dense nav>\n        <v-list-item two-line>\n          <v-list-item-content>\n            <v-list-item-title></v-list-item-title>\n          </v-list-item-content>\n        </v-list-item>\n        <v-list-item-subtitle>users</v-list-item-subtitle>\n        <v-divider></v-divider>\n        <v-list-item v-for=\"item in usersInRoom\" :key=\"item.id\" link>\n          <v-list-item-content v-if=\"allUsersList[item]\">\n            <v-list-item-title>{{ allUsersList[item].name }}</v-list-item-title>\n          </v-list-item-content>\n        </v-list-item>\n      </v-list>\n    </v-navigation-drawer>\n    <v-list>\n      <v-list-item-group>\n        <v-list id=\"listOfText\" class=\"overflow-y-auto\" style=\"max-height: 85vh;\" two-line>\n          <template v-for=\"(item, index) in chatData[this.$router.currentRoute.params.roomId]\">\n            <v-list-item :key=\"index\">\n              <v-list-item-avatar>\n                <img src=\"@/assets/puppy.jpg\" />\n              </v-list-item-avatar>\n              <v-list-item-content v-if=\"allUsersList[item.userId]\">\n                <v-list-item-title v-html=\"allUsersList[item.userId].name\"></v-list-item-title>\n                <v-list-item-subtitle v-html=\"item.text\"></v-list-item-subtitle>\n              </v-list-item-content>\n            </v-list-item>\n          </template>\n        </v-list>\n      </v-list-item-group>\n    </v-list>\n\n    <v-footer style=\"height: 10vh;\" dark fixed>\n      <v-row justify=\"center\" no-gutters>\n        <form @submit.prevent=\"onSubmit\">\n          <v-text-field\n            v-model=\"message\"\n            style=\" display: inline-block;\"\n            label=\"Message\"\n            on:submit.prevent=\"onSubmit\"\n          ></v-text-field>\n          <v-btn\n            type=\"submit\"\n            class=\"ma-2\"\n            style=\" display: inline-block;\"\n            outlined\n            color=\"white\"\n          >Send</v-btn>\n        </form>\n      </v-row>\n    </v-footer>\n  </div>\n</template>\n\n<script>\nimport { mapGetters } from \"vuex\";\nconst axios = require(\"axios\");\nimport store from \"../store\";\n\nexport default {\n  name: \"ChatRoom\",\n  data() {\n    return {\n      message: \"\",\n      roomNum: this.$router.currentRoute.params.roomId,\n      usersInRoom: [],\n      timeoutIds: [],\n    };\n  },\n  beforeDestroy() {\n    this.killTimeouts();\n  },\n  mounted() {\n    this.killTimeouts();\n    this.poll(this.getChatText);\n    this.poll(this.getUserList);\n    this.poll(this.getAllUsers);\n  },\n  methods: {\n    poll: function (cb) {\n      let id = setTimeout(() => {\n        cb()\n          .then(this.poll(cb))\n          .catch(() => {\n            console.error(\"somthing went wrong. please try again later\");\n          });\n      }, 500);\n      this.timeoutIds.push(id);\n    },\n    killTimeouts() {\n      this.timeoutIds.forEach((id) => {\n        clearTimeout(id);\n      });\n    },\n    scrollToEnd: function () {\n      var container = this.$el.querySelector(\"#listOfText\");\n      container.scrollTop = container.scrollHeight;\n    },\n    onSubmit() {\n      if (this.message !== \"\") {\n        return axios\n          .post(`/rooms/${this.roomNum}/text`, {\n            text: this.message,\n            userId: this.loggedinUser.id,\n          })\n          .then(() => {\n            this.getChatText();\n          })\n          .catch(function (error) {\n            console.error(error);\n          });\n      }\n    },\n    getChatText() {\n      return axios\n        .get(`/rooms/${this.roomNum}/text`)\n        .then((response) => {\n          let rId = this.$router.currentRoute.params.roomId;\n          let chatData = [];\n          chatData[rId] = response.data.text;\n          store.dispatch(\"rooms/setChatData\", chatData);\n          this.$nextTick(function () {\n            this.scrollToEnd();\n          });\n        })\n        .catch(function (error) {\n          console.error(error);\n        });\n    },\n    getUserList() {\n      return axios\n        .get(`/rooms/${this.roomNum}/users`)\n        .then((response) => {\n          this.usersInRoom = new Set(response.data.users);\n          store.dispatch(\"rooms/setUsers\", response.data.users);\n        })\n        .catch(function (error) {\n          console.error(error);\n        });\n    },\n\n    getAllUsers() {\n      return axios\n        .get(`/users`)\n        .then((response) => {\n          store.dispatch(\"rooms/setAllUsers\", response.data);\n        })\n        .catch(function (error) {\n          console.error(error);\n        });\n    },\n  },\n  computed: {\n    ...mapGetters({\n      chatData: \"rooms/chatData\",\n      usersList: \"rooms/usersList\",\n      allUsersList: \"rooms/allUsersList\",\n      loggedinUser: \"rooms/loggedinUser\",\n    }),\n  },\n};\n</script>\n\n<style scoped>\n.chatRoom {\n  margin-left: 150px;\n  height: 90vh;\n}\n</style>\n"],"sourceRoot":"src/views"}]}