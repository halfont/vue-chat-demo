{"remainingRequest":"/home/tal/development/vue-scaffold/node_modules/babel-loader/lib/index.js!/home/tal/development/vue-scaffold/node_modules/cache-loader/dist/cjs.js??ref--0-0!/home/tal/development/vue-scaffold/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/tal/development/vue-scaffold/src/views/ChatRoom.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/tal/development/vue-scaffold/src/views/ChatRoom.vue","mtime":1599671028854},{"path":"/home/tal/development/vue-scaffold/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/tal/development/vue-scaffold/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/tal/development/vue-scaffold/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/tal/development/vue-scaffold/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnNldCI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5pdGVyYXRvciI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuaXRlcmF0b3IiOwppbXBvcnQgX29iamVjdFNwcmVhZCBmcm9tICIvaG9tZS90YWwvZGV2ZWxvcG1lbnQvdnVlLXNjYWZmb2xkL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9vYmplY3RTcHJlYWQyIjsKLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KaW1wb3J0IHsgbWFwR2V0dGVycyB9IGZyb20gInZ1ZXgiOwoKdmFyIGF4aW9zID0gcmVxdWlyZSgiYXhpb3MiKTsKCmltcG9ydCBzdG9yZSBmcm9tICIuLi9zdG9yZSI7CmltcG9ydCBwb2xsaW5nIGZyb20gIi4uL21peGluL3BvbGxpbmciOwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogIkNoYXRSb29tIiwKICBtaXhpbnM6IFtwb2xsaW5nXSwKICBkYXRhOiBmdW5jdGlvbiBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgbWVzc2FnZTogIiIsCiAgICAgIHJvb21OdW06IHRoaXMuJHJvdXRlci5jdXJyZW50Um91dGUucGFyYW1zLnJvb21JZCwKICAgICAgdXNlcnNJblJvb206IFtdCiAgICB9OwogIH0sCiAgYmVmb3JlRGVzdHJveTogZnVuY3Rpb24gYmVmb3JlRGVzdHJveSgpIHsKICAgIHRoaXMua2lsbFRpbWVvdXRzKCk7CiAgfSwKICBtb3VudGVkOiBmdW5jdGlvbiBtb3VudGVkKCkgewogICAgdGhpcy5raWxsVGltZW91dHMoKTsKICAgIHRoaXMucG9sbCh0aGlzLmdldENoYXRUZXh0KTsKICAgIHRoaXMucG9sbCh0aGlzLmdldFVzZXJMaXN0KTsKICAgIHRoaXMucG9sbCh0aGlzLmdldEFsbFVzZXJzKTsKICB9LAogIG1ldGhvZHM6IHsKICAgIHNjcm9sbFRvRW5kOiBmdW5jdGlvbiBzY3JvbGxUb0VuZCgpIHsKICAgICAgdmFyIGNvbnRhaW5lciA9IHRoaXMuJGVsLnF1ZXJ5U2VsZWN0b3IoIiNsaXN0T2ZUZXh0Iik7CiAgICAgIGNvbnRhaW5lci5zY3JvbGxUb3AgPSBjb250YWluZXIuc2Nyb2xsSGVpZ2h0OwogICAgfSwKICAgIG9uU3VibWl0OiBmdW5jdGlvbiBvblN1Ym1pdCgpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIGlmICh0aGlzLm1lc3NhZ2UgIT09ICIiKSB7CiAgICAgICAgcmV0dXJuIGF4aW9zLnBvc3QoIi9yb29tcy8iLmNvbmNhdCh0aGlzLnJvb21OdW0sICIvdGV4dCIpLCB7CiAgICAgICAgICB0ZXh0OiB0aGlzLm1lc3NhZ2UsCiAgICAgICAgICB1c2VySWQ6IHRoaXMubG9nZ2VkaW5Vc2VyLmlkCiAgICAgICAgfSkudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgICBfdGhpcy5nZXRDaGF0VGV4dCgpOwogICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikgewogICAgICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0sCiAgICBnZXRDaGF0VGV4dDogZnVuY3Rpb24gZ2V0Q2hhdFRleHQoKSB7CiAgICAgIHZhciBfdGhpczIgPSB0aGlzOwoKICAgICAgcmV0dXJuIGF4aW9zLmdldCgiL3Jvb21zLyIuY29uY2F0KHRoaXMucm9vbU51bSwgIi90ZXh0IikpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgdmFyIHJJZCA9IF90aGlzMi4kcm91dGVyLmN1cnJlbnRSb3V0ZS5wYXJhbXMucm9vbUlkOwogICAgICAgIHZhciBjaGF0RGF0YSA9IFtdOwogICAgICAgIGNoYXREYXRhW3JJZF0gPSByZXNwb25zZS5kYXRhLnRleHQ7CiAgICAgICAgc3RvcmUuZGlzcGF0Y2goInJvb21zL3NldENoYXREYXRhIiwgY2hhdERhdGEpOwoKICAgICAgICBfdGhpczIuJG5leHRUaWNrKGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHRoaXMuc2Nyb2xsVG9FbmQoKTsKICAgICAgICB9KTsKICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7CiAgICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7CiAgICAgIH0pOwogICAgfSwKICAgIGdldFVzZXJMaXN0OiBmdW5jdGlvbiBnZXRVc2VyTGlzdCgpIHsKICAgICAgdmFyIF90aGlzMyA9IHRoaXM7CgogICAgICByZXR1cm4gYXhpb3MuZ2V0KCIvcm9vbXMvIi5jb25jYXQodGhpcy5yb29tTnVtLCAiL3VzZXJzIikpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgX3RoaXMzLnVzZXJzSW5Sb29tID0gbmV3IFNldChyZXNwb25zZS5kYXRhLnVzZXJzKTsKICAgICAgICBzdG9yZS5kaXNwYXRjaCgicm9vbXMvc2V0VXNlcnMiLCByZXNwb25zZS5kYXRhLnVzZXJzKTsKICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7CiAgICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7CiAgICAgIH0pOwogICAgfSwKICAgIGdldEFsbFVzZXJzOiBmdW5jdGlvbiBnZXRBbGxVc2VycygpIHsKICAgICAgcmV0dXJuIGF4aW9zLmdldCgiL3VzZXJzIikudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICBzdG9yZS5kaXNwYXRjaCgicm9vbXMvc2V0QWxsVXNlcnMiLCByZXNwb25zZS5kYXRhKTsKICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7CiAgICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7CiAgICAgIH0pOwogICAgfQogIH0sCiAgY29tcHV0ZWQ6IF9vYmplY3RTcHJlYWQoe30sIG1hcEdldHRlcnMoewogICAgY2hhdERhdGE6ICJyb29tcy9jaGF0RGF0YSIsCiAgICB1c2Vyc0xpc3Q6ICJyb29tcy91c2Vyc0xpc3QiLAogICAgcm9vbUxpc3Q6ICJyb29tcy9yb29tTGlzdCIsCiAgICBhbGxVc2Vyc0xpc3Q6ICJyb29tcy9hbGxVc2Vyc0xpc3QiLAogICAgbG9nZ2VkaW5Vc2VyOiAicm9vbXMvbG9nZ2VkaW5Vc2VyIgogIH0pKQp9Ow=="},{"version":3,"sources":["ChatRoom.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6DA,SAAA,UAAA,QAAA,MAAA;;AACA,IAAA,KAAA,GAAA,OAAA,CAAA,OAAA,CAAA;;AACA,OAAA,KAAA,MAAA,UAAA;AACA,OAAA,OAAA,MAAA,kBAAA;AAEA,eAAA;AACA,EAAA,IAAA,EAAA,UADA;AAEA,EAAA,MAAA,EAAA,CAAA,OAAA,CAFA;AAGA,EAAA,IAHA,kBAGA;AACA,WAAA;AACA,MAAA,OAAA,EAAA,EADA;AAEA,MAAA,OAAA,EAAA,KAAA,OAAA,CAAA,YAAA,CAAA,MAAA,CAAA,MAFA;AAGA,MAAA,WAAA,EAAA;AAHA,KAAA;AAKA,GATA;AAUA,EAAA,aAVA,2BAUA;AACA,SAAA,YAAA;AACA,GAZA;AAaA,EAAA,OAbA,qBAaA;AACA,SAAA,YAAA;AACA,SAAA,IAAA,CAAA,KAAA,WAAA;AACA,SAAA,IAAA,CAAA,KAAA,WAAA;AACA,SAAA,IAAA,CAAA,KAAA,WAAA;AACA,GAlBA;AAmBA,EAAA,OAAA,EAAA;AAEA,IAAA,WAAA,EAAA,uBAAA;AACA,UAAA,SAAA,GAAA,KAAA,GAAA,CAAA,aAAA,CAAA,aAAA,CAAA;AACA,MAAA,SAAA,CAAA,SAAA,GAAA,SAAA,CAAA,YAAA;AACA,KALA;AAMA,IAAA,QANA,sBAMA;AAAA;;AACA,UAAA,KAAA,OAAA,KAAA,EAAA,EAAA;AACA,eAAA,KAAA,CACA,IADA,kBACA,KAAA,OADA,YACA;AACA,UAAA,IAAA,EAAA,KAAA,OADA;AAEA,UAAA,MAAA,EAAA,KAAA,YAAA,CAAA;AAFA,SADA,EAKA,IALA,CAKA,YAAA;AACA,UAAA,KAAA,CAAA,WAAA;AACA,SAPA,EAQA,KARA,CAQA,UAAA,KAAA,EAAA;AACA,UAAA,OAAA,CAAA,KAAA,CAAA,KAAA;AACA,SAVA,CAAA;AAWA;AACA,KApBA;AAqBA,IAAA,WArBA,yBAqBA;AAAA;;AACA,aAAA,KAAA,CACA,GADA,kBACA,KAAA,OADA,YAEA,IAFA,CAEA,UAAA,QAAA,EAAA;AACA,YAAA,GAAA,GAAA,MAAA,CAAA,OAAA,CAAA,YAAA,CAAA,MAAA,CAAA,MAAA;AACA,YAAA,QAAA,GAAA,EAAA;AACA,QAAA,QAAA,CAAA,GAAA,CAAA,GAAA,QAAA,CAAA,IAAA,CAAA,IAAA;AACA,QAAA,KAAA,CAAA,QAAA,CAAA,mBAAA,EAAA,QAAA;;AACA,QAAA,MAAA,CAAA,SAAA,CAAA,YAAA;AACA,eAAA,WAAA;AACA,SAFA;AAGA,OAVA,EAWA,KAXA,CAWA,UAAA,KAAA,EAAA;AACA,QAAA,OAAA,CAAA,KAAA,CAAA,KAAA;AACA,OAbA,CAAA;AAcA,KApCA;AAqCA,IAAA,WArCA,yBAqCA;AAAA;;AACA,aAAA,KAAA,CACA,GADA,kBACA,KAAA,OADA,aAEA,IAFA,CAEA,UAAA,QAAA,EAAA;AACA,QAAA,MAAA,CAAA,WAAA,GAAA,IAAA,GAAA,CAAA,QAAA,CAAA,IAAA,CAAA,KAAA,CAAA;AACA,QAAA,KAAA,CAAA,QAAA,CAAA,gBAAA,EAAA,QAAA,CAAA,IAAA,CAAA,KAAA;AACA,OALA,EAMA,KANA,CAMA,UAAA,KAAA,EAAA;AACA,QAAA,OAAA,CAAA,KAAA,CAAA,KAAA;AACA,OARA,CAAA;AASA,KA/CA;AAiDA,IAAA,WAjDA,yBAiDA;AACA,aAAA,KAAA,CACA,GADA,WAEA,IAFA,CAEA,UAAA,QAAA,EAAA;AACA,QAAA,KAAA,CAAA,QAAA,CAAA,mBAAA,EAAA,QAAA,CAAA,IAAA;AACA,OAJA,EAKA,KALA,CAKA,UAAA,KAAA,EAAA;AACA,QAAA,OAAA,CAAA,KAAA,CAAA,KAAA;AACA,OAPA,CAAA;AAQA;AA1DA,GAnBA;AA+EA,EAAA,QAAA,oBACA,UAAA,CAAA;AACA,IAAA,QAAA,EAAA,gBADA;AAEA,IAAA,SAAA,EAAA,iBAFA;AAGA,IAAA,QAAA,EAAA,gBAHA;AAIA,IAAA,YAAA,EAAA,oBAJA;AAKA,IAAA,YAAA,EAAA;AALA,GAAA,CADA;AA/EA,CAAA","sourcesContent":["<template>\n  <div class=\"chatRoom\">\n    <v-navigation-drawer :permanent=\"true\" absolute dark fixed :width=\"150\">\n      <v-list dense nav>\n        <v-list-item two-line>\n          \n          <v-list-item-content >\n            \n            <v-list-item-title class=\"d-flex justify-center font-weight: bold;\" >{{roomList[roomNum].name}}</v-list-item-title>\n          </v-list-item-content>\n        </v-list-item>\n        <v-divider></v-divider>\n        \n        <v-list-item v-for=\"item in usersInRoom\" :key=\"item.id\" link>\n          <v-list-item-content v-if=\"allUsersList[item]\">\n            <v-list-item-title class=\"d-flex justify-center\">{{ allUsersList[item].name }}</v-list-item-title>\n          </v-list-item-content>\n        </v-list-item>\n      </v-list>\n    </v-navigation-drawer>\n    <v-list>\n      <v-list-item-group>\n        <v-list id=\"listOfText\" class=\"overflow-y-auto\" style=\"max-height: 85vh;\" two-line>\n          <template v-for=\"(item, index) in chatData[this.$router.currentRoute.params.roomId]\">\n            <v-list-item :key=\"index\">\n              <v-list-item-avatar>\n                <img src=\"@/assets/puppy.jpg\" />\n              </v-list-item-avatar>\n              <v-list-item-content v-if=\"allUsersList[item.userId]\">\n                <v-list-item-title v-html=\"allUsersList[item.userId].name\"></v-list-item-title>\n                <v-list-item-subtitle v-html=\"item.text\"></v-list-item-subtitle>\n              </v-list-item-content>\n            </v-list-item>\n          </template>\n        </v-list>\n      </v-list-item-group>\n    </v-list>\n\n    <v-footer style=\"height: 10vh;\" dark fixed>\n      <v-row justify=\"center\" no-gutters>\n        <form @submit.prevent=\"onSubmit\">\n          <v-text-field\n            v-model=\"message\"\n            style=\" display: inline-block;\"\n            label=\"Message\"\n            on:submit.prevent=\"onSubmit\"\n          ></v-text-field>\n          <v-btn\n            type=\"submit\"\n            class=\"ma-2\"\n            style=\" display: inline-block;\"\n            outlined\n            color=\"white\"\n          >Send</v-btn>\n        </form>\n      </v-row>\n    </v-footer>\n  </div>\n</template>\n\n<script>\nimport { mapGetters } from \"vuex\";\nconst axios = require(\"axios\");\nimport store from \"../store\";\nimport polling from \"../mixin/polling\"\n\nexport default {\n  name: \"ChatRoom\",\n  mixins: [polling],\n  data() {\n    return {\n      message: \"\",\n      roomNum: this.$router.currentRoute.params.roomId,\n      usersInRoom: [],\n    };\n  },\n  beforeDestroy() {\n    this.killTimeouts();\n  },\n  mounted() {\n    this.killTimeouts();\n    this.poll(this.getChatText);\n    this.poll(this.getUserList);\n    this.poll(this.getAllUsers);\n  },\n  methods: {\n\n    scrollToEnd: function () {\n      var container = this.$el.querySelector(\"#listOfText\");\n      container.scrollTop = container.scrollHeight;\n    },\n    onSubmit() {\n      if (this.message !== \"\") {\n        return axios\n          .post(`/rooms/${this.roomNum}/text`, {\n            text: this.message,\n            userId: this.loggedinUser.id,\n          })\n          .then(() => {\n            this.getChatText();\n          })\n          .catch(function (error) {\n            console.error(error);\n          });\n      }\n    },\n    getChatText() {\n      return axios\n        .get(`/rooms/${this.roomNum}/text`)\n        .then((response) => {\n          let rId = this.$router.currentRoute.params.roomId;\n          let chatData = [];\n          chatData[rId] = response.data.text;\n          store.dispatch(\"rooms/setChatData\", chatData);\n          this.$nextTick(function () {\n            this.scrollToEnd();\n          });\n        })\n        .catch(function (error) {\n          console.error(error);\n        });\n    },\n    getUserList() {\n      return axios\n        .get(`/rooms/${this.roomNum}/users`)\n        .then((response) => {\n          this.usersInRoom = new Set(response.data.users);\n          store.dispatch(\"rooms/setUsers\", response.data.users);\n        })\n        .catch(function (error) {\n          console.error(error);\n        });\n    },\n\n    getAllUsers() {\n      return axios\n        .get(`/users`)\n        .then((response) => {\n          store.dispatch(\"rooms/setAllUsers\", response.data);\n        })\n        .catch(function (error) {\n          console.error(error);\n        });\n    },\n  },\n  computed: {\n    ...mapGetters({\n      chatData: \"rooms/chatData\",\n      usersList: \"rooms/usersList\",\n      roomList: \"rooms/roomList\",\n      allUsersList: \"rooms/allUsersList\",\n      loggedinUser: \"rooms/loggedinUser\",\n    }),\n  },\n};\n</script>\n\n<style scoped>\n.chatRoom {\n  margin-left: 150px;\n  height: 90vh;\n}\n</style>\n"],"sourceRoot":"src/views"}]}